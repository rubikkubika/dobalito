# Phone Authentication Testing Guide

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è **—Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞** - –∫–æ–¥—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ API –≤–º–µ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É.

## –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º

### ‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:
- –ö–æ–¥—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ **–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ JSON –æ—Ç–≤–µ—Ç–µ**
- SMS –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ö–æ–¥—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã 10 –º–∏–Ω—É—Ç
- –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω–æ–≤

### üîß API Endpoints –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## 1. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST -H "Content-Type: application/json" \
  -d '{"phone":"+79252238664"}' \
  http://localhost:8080/api/v1/auth/send-verification-code
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –Ω–æ–º–µ—Ä 79252238664",
  "phone": "79252238664",
  "code": "089173",           // ‚Üê –ö–û–î –î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
  "expiresAt": "2025-10-10T11:48:50.1519433",
  "expiresInMinutes": 10
}
```

## 2. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–¥–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST -H "Content-Type: application/json" \
  -d '{"phone":"79252238664","code":"089173","name":"–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"}' \
  http://localhost:8080/api/v1/auth/verify-code
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è",
  "token": "eyJhbGciOiJIUzI1NiJ9...",  // ‚Üê JWT –¢–û–ö–ï–ù
  "user": {
    "id": 8,
    "name": "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "phone": "79252238664",
    "email": "temp_79252238664@dobalito.local",
    "avatar": ""
  }
}
```

## 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å JWT)

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiJ9..." \
  http://localhost:8080/api/v1/auth/me
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "user": {
    "id": 8,
    "name": "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "phone": "79252238664",
    "email": "temp_79252238664@dobalito.local",
    "avatar": ""
  }
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
### 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
### 3. –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É –∏ –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
### 4. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥"
### 5. **–û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) ‚Üí Network**
### 6. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `send-verification-code`
### 7. –í –æ—Ç–≤–µ—Ç–µ –Ω–∞–π–¥–∏—Ç–µ –ø–æ–ª–µ `code` - —ç—Ç–æ –≤–∞—à –∫–æ–¥ –¥–ª—è –≤–≤–æ–¥–∞
### 8. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –≤ —Ñ–æ—Ä–º—É –∏ –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∫–æ–¥"

## –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞

–í –ª–æ–≥–∞—Ö backend'–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
=== –¢–ï–°–¢–û–í–´–ô –†–ï–ñ–ò–ú ===
–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞: 79252238664
–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏: 089173
–ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ: 2025-10-10T11:48:50.1519433
===================
```

## –¢–µ—Å—Ç–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞

–ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—ã–µ –Ω–æ–º–µ—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

| –°—Ç—Ä–∞–Ω–∞ | –ö–æ–¥ | –ù–æ–º–µ—Ä | –ü–æ–ª–Ω—ã–π –Ω–æ–º–µ—Ä |
|--------|-----|-------|--------------|
| üá∑üá∫ –†–æ—Å—Å–∏—è | +7 | 925 223 86 64 | +79252238664 |
| üá∫üá∏ –°–®–ê | +1 | 555 123 45 67 | +15551234567 |
| üá©üá™ –ì–µ—Ä–º–∞–Ω–∏—è | +49 | 30 123 45 67 | +49301234567 |

## –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞

JWT —Ç–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç:
- `phone` - –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- `name` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
- `userId` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `type` - "phone_auth"
- `iat` - –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
- `exp` - –≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è

–ú–æ–∂–µ—Ç–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –Ω–∞ https://jwt.io –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ.

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–¥–æ–≤:
- –ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 10 –º–∏–Ω—É—Ç
- –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ –≤–≤–æ–¥–∞
- –ü–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è

### –õ–∏–º–∏—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏:
- –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ —á–∞—Å
- –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –∫–æ–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è

### –§–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞:
- –ù–æ–º–µ—Ä–∞ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è (—É–±–∏—Ä–∞—é—Ç—Å—è –≤—Å–µ —Å–∏–º–≤–æ–ª—ã –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–æ–º–µ—Ä–∞ –æ—Ç 10 –¥–æ 15 —Ü–∏—Ñ—Ä

## –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º

–î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS:

1. **–û–±–Ω–æ–≤–∏—Ç–µ AuthController:**
```java
// –í–º–µ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–æ–¥–∞ –≤ –æ—Ç–≤–µ—Ç–µ:
return ResponseEntity.ok(Map.of(
    "success", true,
    "message": "–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –Ω–æ–º–µ—Ä " + normalizedPhone,
    "phone", normalizedPhone,
    "expiresInMinutes", 10
    // –£–±—Ä–∞—Ç—å "code" –∏–∑ –æ—Ç–≤–µ—Ç–∞
));

// –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É SMS:
boolean smsSent = smsService.sendVerificationCode(normalizedPhone, verificationCode.getCode());
if (!smsSent) {
    return ResponseEntity.status(500).body(Map.of(
        "success", false,
        "message", "–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS"
    ));
}
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π SMS API –≤ SmsService**

3. **–£–±–µ—Ä–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–æ–≤ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω**

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- ‚úÖ –ë—ã—Å—Ç—Ä–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- ‚úÖ –ù–µ —Ç—Ä–∞—Ç–∏—Ç—å –¥–µ–Ω—å–≥–∏ –Ω–∞ SMS
- ‚úÖ –†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å—é –ª–æ–≥–∏–∫—É JWT —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é! üöÄ
