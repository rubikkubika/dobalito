# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º JWT —Ç–æ–∫–µ–Ω–∞

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –∑–∞—Ö–æ–¥–∏—Ç—å –≤ –ø—Ä–æ—Ñ–∏–ª—å, –Ω–æ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—è–≤–ª—è–ª–∞—Å—å –æ—à–∏–±–∫–∞ 403 Forbidden:

```
GET http://localhost:8080/api/v1/users/profile 403 (Forbidden)
```

**–ü—Ä–∏—á–∏–Ω–∞:** JWT —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ, –Ω–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ –∑–Ω–∞–µ—Ç –æ–± —ç—Ç–æ–º –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å—á–∏—Ç–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ 401 –≤ apiService.ts

```typescript
// Response interceptor
api.interceptors.response.use(
  (response) => {
    return response;
  },
  (error) => {
    if (error.response?.status === 401) {
      console.log('Unauthorized access - JWT token expired or invalid');
      
      // –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      localStorage.removeItem('user');
      
      // –£–≤–µ–¥–æ–º–ª—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–± –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞
      window.dispatchEvent(new CustomEvent('auth-expired'));
      
      // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
      if (error.config?.url?.includes('/auth/me') || error.config?.url?.includes('/users/profile')) {
        console.log('Silent auth check failed - user not authenticated');
        return Promise.reject(new Error('UNAUTHORIZED_SILENT'));
      }
    }
    return Promise.reject(error);
  }
);
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω AuthContext.tsx

```typescript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —á–µ—Ä–µ–∑ API
useEffect(() => {
  const checkAuth = async () => {
    try {
      const response = await apiService.getCurrentUser();
      if (response.success) {
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        setUser(userData);
      }
    } catch (err: any) {
      // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫
      if (err.message === 'UNAUTHORIZED_SILENT') {
        console.log('Silent auth check - user not authenticated');
      } else {
        console.log('Auth check failed:', err.message);
      }
      setUser(null);
    }
  };

  checkAuth();
}, []);
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω HomePage.tsx

```typescript
try {
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
  if (isAuthenticated) {
    const userProfile = await apiService.getUserProfile();
    dispatch({ type: 'SET_USER', payload: userProfile });
  }
} catch (error: any) {
  console.error('Error fetching data:', error);
  // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–ª–∏ –∏—Å—Ç–µ–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤
  if (isAuthenticated && error.message !== 'UNAUTHORIZED_SILENT') {
    dispatch({ type: 'SET_ERROR', payload: '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö' });
  }
}
```

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –¢–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
2. ‚úÖ API –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
3. ‚úÖ –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –¢–æ–∫–µ–Ω –∏—Å—Ç–µ–∫
1. ‚è∞ JWT —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
2. üîí –ë—ç–∫–µ–Ω–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized
3. üßπ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. üîÑ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
5. üìù –í –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "Silent auth check - user not authenticated"

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∏—Å—Ç–µ–∫—à–∏–º —Ç–æ–∫–µ–Ω–æ–º
1. üîÑ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
2. üîç AuthContext –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ API
3. ‚ùå API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 (—Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫)
4. üßπ –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—á–∏—â–∞–µ—Ç—Å—è
5. ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ UI –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

## üìã –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

- ‚úÖ **–ù–µ—Ç –æ—à–∏–±–æ–∫ 403** –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ **–ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ **–¢–∏—Ö–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –±–µ–∑ –ø–æ–∫–∞–∑–∞ –æ—à–∏–±–æ–∫

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å** —á–µ—Ä–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω
2. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 30 —Å–µ–∫—É–Ω–¥** (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞)
3. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É**
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å** - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å
5. **–£–±–µ–¥–∏—Ç–µ—Å—å** —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–ª–æ–≥–∏–Ω–µ–Ω

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- **–¢–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - 30 —Å–µ–∫—É–Ω–¥ —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞
- **–ù–µ—Ç –ø–æ–∫–∞–∑–∞ –æ—à–∏–±–æ–∫** –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è (–∏—Å—Ç–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞)
- **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞** —Å HttpOnly cookies
